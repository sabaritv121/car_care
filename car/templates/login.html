<!doctype html>
{% load static %}
{% load crispy_forms_filters %}
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> car care</title>

    <link rel="shortcut icon" href="{% static 'asset1/assets/images/fav.jpg' %}">
    <link rel="stylesheet" href="{% static 'asset1/assets/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'asset1/assets/css/fontawsom-all.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'asset1/assets/css/style.css' %}" />
</head>

<body class="h-100">
    <div class="container-fluid full-bg h-100">
        <div class="container h-100">
            <div class="row no-margin h-100">
                <div class="bg-layer d-flex col-md-4">
                    <div class="login-box row">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="home" aria-selected="true"><i class="fas fa-unlock-alt"></i> login</a>
                            </li>
                            {% comment %} <li class="nav-item">
                                <a class="nav-link" id="signup-tab" data-toggle="tab" href="#signup" role="tab" aria-controls="profile" aria-selected="false"><i class="fas fa-user-plus"></i> Register</a>
                            </li>  {% endcomment %}
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                                create account
                              </button>
                              {% comment %} <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleMod">
                                Register EMPLOYEE
                              </button> {% endcomment %}
                        </ul>
                <form action="#" class="login-form" method="POST">
                    {% csrf_token %}
                        <div class="tab-content w-100" id="myTabContent">
                            <div class="tab-pane   fade show active" id="login" role="tabpanel" aria-labelledby="home-tab">
                               <div class="login-tab">
                                <h3>User login</h3>
                                
                               <div class="form-row">

                                   <input placeholder="Enter Username" name='uname' class="form-control form-control-sm" type="text">
                               </div>

                               <div class="form-row">

                                   <input placeholder="Enter Password" name = 'pass' class="form-control form-control-sm" type="password">
                                  
                               </div>
                            



                                <div class=" forget">

                                   {% comment %} <p> forget password ?</p> {% endcomment %}
                                {% comment %} <button class="btn btn-success btn-sm">Login</button> {% endcomment %}

                                <div class="form-group">
                                    <button type="submit" class="btn btn-success btn-sm">Get Started</button>
                                </div>
                         </form>
                               </div>
                                </div>

                            </div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">REGISTER</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
         {% comment %} form {% endcomment %}
        
            <form id = 'LoginRegister' >
            {% csrf_token %}
         {{form|crispy}}
       
        {% comment %} <div class=" forget">
           <br> {% endcomment %}

          <button type = 'submit' class="btn btn-success w-100 btn-sm" >Sign Up</button>  
          {% comment %} <button type="submit"> submit </button> {% endcomment %}

        </form>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>

{% comment %} <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> {% endcomment %}
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
        <!-- Add this script block to your template -->
        



        {% comment %} <script>
          $(document).ready(function() {
            $('#LoginRegister').submit(function(event) {
              // Validate the form before submitting
              if (!validateForm()) {
                event.preventDefault(); // Prevent the form from submitting normally
                return false;
              }
              else {
                $.ajax({
                  type: 'post', // Get the form's method attribute
                  url: 'UserAddView', // Get the form's action attribute
                  data: $(this).serialize(), // Serialize the form data
                  success: function(response) {
                    // Handle the server's response here
                    alert('Form submitted successfully!');
                  },
                  error: function(xhr, status, error) {
                    // Handle errors here
                    alert('An error occurred while submitting the form.');
                    console.error(xhr.responseText);
                  }
                });
              }
            });
        
            function validateForm() {
              // Get the form inputs
              var username = $('#id_username').val().trim();
              var password1 = $('#id_password1').val().trim();
              var password2 = $('#id_password2').val().trim();
              var phone = $('#id_phone_number').val().trim();
        
              // Check for empty fields
              if (username === '' || password1 === '' || password2 === ''  || phone === '') {
                alert('Please fill in all fields.');
                return false;
              }
        
              // Check that passwords match
              if (password1 !== password2) {
                alert('Passwords do not match.');
                return false;
              }
        
              // Check password length
              if (password1.length < 8) {
                alert('Password must be at least 8 characters long.');
                return false;
              }
        
              // Check username length
              if (username.length < 4 || username.length > 20) {
                alert('Username must be between 4 and 20 characters long.');
                return false;
              }
        
              // Check phone number format
              if (!isValidPhoneNumber(phone)) {
                alert('Please enter a valid phone number.');
                return false;
              }
        
              return true;
            }
        
            function isValidPhoneNumber(phone) {
              // Regular expression for phone number validation
              var phoneRegex = /^[0-9]{10}$/;
              return phoneRegex.test(phone);
            }
          });
        </script> {% endcomment %}
            
        <script>
          $(document).ready(function() {
            
            $('#LoginRegister').validate({
              rules: {
              username: {
                  required: true,
                  minlength: 4,
                  maxlength: 20,
                  remote: { 
                    url: 'username_exists', // The URL to check if the username already exists
                    type: 'post',
                    data: {
                      username: function() {
                        return $('#id_username').val();
                      }
                    }
                  } 
                }, 

                
                password1: {
                  required: true,
                  minlength: 8,
                },
                password2: {
                  required: true,
                  equalTo: '#id_password1',
                },
                phone_number: {
                  required: true,
                  minlength: 10,
                  maxlength: 10,
                  digits: true,
                },
                
              },
              messages: {
                username: {
                  required: 'Please enter a username.',
                  minlength: 'Username must be at least 4 characters long.',
                  maxlength: 'Username must be at most 20 characters long.',
                  remote: 'Username already exists. Please choose a different username.', // The message to display if the username already exists 
                },
                password1: {
                  required: 'Please enter a password.',
                  minlength: 'Password must be at least 8 characters long.',
                },
                password2: {
                  required: 'Please confirm your password.',
                  equalTo: 'Passwords do not match.',
                },
                phone_number: {
                  required: 'Please enter a phone number.',
                  minlength: 'Phone number must be 10 digits long.',
                  maxlength: 'Phone number must be 10 digits long.',
                  digits: 'Please enter a valid phone number.',
                },
                
              },
              
              submitHandler: function(form) {
                $.ajax({
                  type: 'post', // Get the form's method attribute
                  url: 'UserAddView', // Get the form's action attribute
                  data: $(form).serialize(), // Serialize the form data
                  success: function(response) {
                    // Handle the server's response here
                    alert('Form submitted successfully!');
               
                  },
                  error: function(xhr, status, error) {
                    // Handle errors here
                    alert('An error occurred while submitting the form.');
                    console.error(xhr.responseText);
                  }
                });
              }
            });
          
            
          });
        </script>

             



        </div>
         </div>
     </div>
        

                                  

        
        {% comment %} <div class="modal-footer"> {% endcomment %}
          {% comment %} <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> {% endcomment %}
          {% comment %} <button type="button" class="btn btn-primary">Save changes</button> {% endcomment %}
        {% comment %} </div> {% endcomment %}
      </div>
    </div>


    <!-- Modal -->
<div class="modal fade" id="exampleMod" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">REGISTER</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
         {% comment %} form {% endcomment %}
         {{employee_form.as_p}}
          
        <div class=" forget">
           <br>

         <button class="btn btn-success w-100 btn-sm">Sign Up</button>
        </div>
         </div>
     </div>

     

                            {% comment %} <div class="tab-pane fade" id="signup" role="tabpanel" aria-labelledby="profile-tab">
                                 <div class="login-tab">
                                 <h3>User login</h3>

                               <div class="form-row">

                                   <input placeholder="Enter Full Name" class="form-control form-control-sm" type="text">
                               </div>

                               <div class="form-row">

                                   <input placeholder="Enter Email Address" class="form-control form-control-sm" type="text">
                               </div>
                                <div class="form-row">

                                   <input placeholder="Enter Password" class="form-control form-control-sm" type="text">
                               </div>
                                <div class="form-row">

                                   <input placeholder="Confirm Password" class="form-control form-control-sm" type="text">
                               </div>
                               <div class=" forget">
                                  <br>

                                <button class="btn btn-success w-100 btn-sm">Sign Up</button>
                               </div>
                                </div>
                            </div>

                        </div> {% endcomment %}




                    </div>
                </div>
            </div>

            
        </div>

    </div>
</body>

{% comment %} <script src="{% static 'asset1/assets/js/jquery-3.2.1.min.js' %}"></script>
<script src="{% static 'asset1/assets/js/popper.min.js' %}"></script>
<script src="{% static 'asset1/assets/js/bootstrap.min.js' %}"></script>
<script src="{% static 'asset1/assets/js/script.js' %}"></script> {% endcomment %}


</html>