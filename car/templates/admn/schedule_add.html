{% extends 'admn/dashboard.html'%}

{% load crispy_forms_filters %}
{% block content %}

    


<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#example">
    Add Schedule +
  </button>

  <div id="result1"></div>

<div class="modal fade" id="example" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">ADD SCHEDULE</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
         {% comment %} form {% endcomment %}
         <form id = 'ScheduleAdd'>
            {% csrf_token %}


         {{form|crispy}}
          
        <div class=" forget">
           <br>

         <button type= "submit" class="btn btn-success w-100 btn-sm">ADD</button>
         {% comment %} <button type="submit"> submit </button> {% endcomment %}
         {% for message in messages %}
         <div class="alert alert-primary" role="alert">
             {{message}}
         </div>
         {% endfor %}
        </form>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>

{% comment %} <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> {% endcomment %}
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
        

       
          


        <script>

          
            $(document).ready(function() {

                  if($('#result1') != null){
                    Read();
                }
            
                $('#ScheduleAdd').submit(function(event) {
                  // Validate the form before submitting
                
                    event.preventDefault(); // Prevent the form from submitting normally
                    
            
               
                    $.ajax({
                      type: 'post', // Get the form's method attribute
                      url: 'ScheduleAddView', // Get the form's action attribute
                      data: $(this).serialize(), // Serialize the form data
                      success: function(response) {
                        if (response !== 'True') {
                          alert('Form validation failed: ' + response.message);
                        } else {
                          alert('Form submitted successfully!');
                          Read();
                        }
                      }
                       
                    });
                  
                });
            
                
              });


              function Read(){
                $.ajax({
                    async : 'true',
                    url: 'read',
                    type: 'POST',
            
                    data:{
                        res: 1,
                        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                    },
                    success: function(response){
                        $('#result1').html(response);
                    }
                });
            }
            
            $(document).ready(function() {
              $(document).on("click",".toggle-active-btn",function() {
                var category_id = $(this).data('category-id');
                var csrf_token = $(this).data('csrf-token');
                
                $.ajax({
                  url: '/category/' + category_id + '/toggle-active/',
                  method: 'POST',
                  data: {
                    'csrfmiddlewaretoken': csrf_token
                  },
                  success: function(response) {
                    if (response.status === 'success') {
                      $('.toggle-active-btn[data-category-id=' + category_id + ']').text(response.is_active ? 'Disable' : 'Enable');
                    } else {
                      alert(response.message);
                    }
                  },
                  error: function(xhr, status, error) {
                    console.log('Error:', error);
                  }
                });
              });
          });
            
           
          </script>
        


            {% endblock %}